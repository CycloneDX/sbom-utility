{
  "validation": {
    "description": "Custom validation actions test a BOM for a representative set of \"best practices\" elements or \"profile\".",
    "actions": [
      {
        "id": "custom-best-practices-profile",
        "description": "Test the BOM has 'metadata', 'components' and 'dependencies' at the top level as \"best practice\".",
        "selector": {
          "path": ""
        },
        "functions": [
          "hasProperties"
        ],
        "properties": [
          {
            "key": "metadata"
          },
          {
            "key": "components"
          },
          {
            "key": "dependencies"
          }
        ]
      },
      {
        "id": "custom-test-metadata-has-elements",
        "description": "Test the 'metadata' element contains required child elements which are a mix of primitives and complex types.",
        "selector": {
          "path": "metadata"
        },
        "functions": [
          "hasProperties"
        ],
        "properties": [
          {
            "key": "timestamp"
          },
          {
            "key": "component"
          },
          {
            "key": "supplier"
          }
        ]
      },
      {
        "id": "custom-metadata-properties-unique-disclaimer",
        "description": "Validate BOM metadata properties has a unique, specific disclaimer value.",
        "selector": {
          "path": "metadata.properties",
          "primaryKey": {
            "key": "name",
            "value": "urn:example.com:disclaimer"
          }
        },
        "functions": [
          "isUnique",
          "hasProperties"
        ],
        "properties": [
          {
            "key": "name",
            "value": "urn:example.com:disclaimer"
          },
          {
            "key": "value",
            "value": "This SBOM is current as of the date it was generated and is subject to change\\."
          }
        ]
      },
      {
        "id": "custom-metadata-component-hashes",
        "description": "Validate BOM metadata component has a single, SHA-356 hash value.",
        "selector": {
          "path": "metadata.component.hashes",
          "primaryKey": {
            "key": "alg",
            "value": "SHA-256"
          }
        },
        "functions": [
          "isUnique",
          "hasProperties"
        ],
        "primaryKey": {
          "key": "alg",
          "value": "SHA-256"
        },
        "properties": [
          {
            "key": "content",
            "value": "^[0-9a-fA-F]{64}$"
          }
        ]
      },
      {
        "id": "custom-external-reference-support",
        "description": "Validate BOM 'externalReferences' include a support URL.",
        "selector": {
          "path": "externalReferences",
          "primaryKey": {
            "key": "url",
            "value": "support@example.com"
          }
        },
        "functions": [
          "hasProperties"
        ],
        "primaryKey": {
          "key": "url",
          "value": "support@example.com"
        },
        "properties": [
          {
            "key": "type",
            "value": "support"
          }
        ]
      }
    ]
  }
}